<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Veritone Docs</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="Veritone Docs">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <link rel="apple-touch-icon"
    sizes="180x180"
    href="https://static.veritone.com/assets/favicon/apple-touch-icon.png?v=lkgpRBRLYl"
  >
  <link rel="icon"
    type="image/png"
    href="https://static.veritone.com/assets/favicon/favicon-32x32.png?v=lkgpRBRLYl"
    sizes="32x32"
  >
  <link rel="icon"
    type="image/png"
    href="https://static.veritone.com/assets/favicon/favicon-16x16.png?v=lkgpRBRLYl"
    sizes="16x16"
  >
  <link rel="mask-icon"
    href="https://static.veritone.com/assets/favicon/safari-pinned-tab.svg?v=lkgpRBRLYl"
    color="#597cb1"
  >
  <link rel="shortcut icon"
    href="https://static.veritone.com/assets/favicon/favicon.ico"
    type="image/x-icon"
  >
  <link rel="stylesheet" href="//unpkg.com/docsify/lib/themes/vue.css">
  <link rel="stylesheet" href="//unpkg.com/docsify-copy-code/styles.css">

  <!--Custom Veritone CSS-->
  <style>

    /* For collapsing all but current page */
    .sidebar-nav .collapse ul {
      display: none;
    }

    /**
     * For highlighting the currently selected page
     * Because the default assumes you only want things highlighted if they don't have any subpages
     **/
    .sidebar-nav .active > a {
      border-right: 2px solid;
      color: var(--theme-color,#42b983);
      font-weight: 600;
    }

    /* Provide some differentiation between section headings and sub-pages in the sidebar */
    .sidebar-nav .section-link {
      font-style: italic;
    }
  </style>
</head>
<body>
  <nav>
    <a href="https://chat.veritone.com/" target="_blank"><img src="/slack.svg" style="margin-right: 5px"/>Join us on Slack</a>
    <a id="new-issue-link" href="javascript:void(0)"><img src="/github.png" style="width:16px; margin-right: 5px"/>File an Issue</a>
  </nav>
  <div id="app"></div>
  <!-- <script src="//unpkg.com/docsify-copy-code/index.js"></script> -->
  <script>
    window.$docsify = {
      search: 'auto', // default
      maxLevel: 1,
      name: '<div><img src="https://static.veritone.com/assets/favicon/favicon.ico" height="18px" width="18px" style="margin-right: 5px" /> Veritone Docs</div>',
      repo: '',
      // routerMode: 'history',
      subMaxLevel: 2,
      loadSidebar: true,
      auto2top: true,
      // notFoundPage: {
      //   '\/(.*)(?<!\/)$': '1$/'
      // }
      alias: {
        '/.*/_sidebar.md': '/_sidebar.md',

        // TODO: Figure out how to make these redirects instead of aliases

        // Permalinks to support legacy developer-only file structure
        '^\/applications/(.*)$': '/developer/applications/$1',
        '^\/data/(.*)$': '/developer/data/$1',
        '^\/engines/(.*)$': '/developer/engines/$1',
        '^\/libraries/(.*)$': '/developer/libraries/$1',
        '^\/veritone-developer-overview(|.md)$': '/developer/',
        '^\/developer-benefits(|.md)$': '/developer/benefits',
        '^\/terms-and-conditions(|.md)$': '/developer/terms-and-conditions',

        // TODO: change convention to use README files and just always alias no-trailing-slash to trailing-slash
        '^\/apis$': '/apis/',
        '^\/apis\/tutorials$': '/apis/tutorials/',
        '^\/developer\/applications$': '/developer/applications/',
        '^\/developer\/data$': '/developer/data/',
        '^\/developer\/engines$': '/developer/engines/',
        '^\/developer/libraries$': '/developer/libraries/',
        '^\/engines\/classes$': '/engines/classes/',
        '^\/engines\/guidelines$': '/engines/guidelines/',
        '^\/engines\/engine-input-output$': '/engines/engine-input-output/',
        '^\/engines\/tutorials$': '/engines/tutorials/',
        '(.*)\/quick-start$': '$1/quick-start/'
      }
      // plugins: [
      //   window.DocsifyCopyCodePlugin.init()
      // ]
    }
    document.getElementById('new-issue-link').addEventListener('click', function() {
      window.open('https://github.com/veritone/docs/issues/new?title=' + encodeURIComponent('Issue on page: ' + (document.location.hash.slice(2) || 'Home')));
    });
  </script>
  <script src="//unpkg.com/docsify/lib/docsify.min.js"></script>
  <script src="//unpkg.com/docsify/lib/plugins/search.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-bash.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-graphql.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-python.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-json.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-http.min.js"></script>

  <!--Custom script to collapse all other sidebar links besides active page-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>
    var RECURSION_LIMIT = 50;
    var collapseNavElRecursion = 0;
    var collapseExtendedFamilyRecursion = 0;

    // Custom docsify plugins
    window.$docsify.plugins = [

      /**
       * Sidebar Collapse
       * Makes all elements of the sidebar that aren't directly around the current node collapse
       * Leaves only the parent hierarchy leading to the current node and the first-level children of the current node expanded.
       **/
      function (hook, vm) {
        hook.doneEach(function onPageChanged() {
          collapseExtendedFamilyRecursion = 0;
          var activeEl = $('.sidebar-nav .active');
          collapseChildren(activeEl);
          collapseExtendedFamily(activeEl);
        });
      },

      /**
       * "Support" Badges
       * Replaces instances of `![](badge/API/Yes/green)` with a badge from shields.io
       * with a label of "API Support", a value of "Yes", and a color of green.
       **/
      function (hook, vm) {
        hook.beforeEach(function onBeforePageParsed(content) {
          var BADGE_REGEX = /!\[]\(badge\/(\w+)\/(\w+)\/(\w+)\)/g;
          // TODO: Wrap with link to explanations of what API, Search, and UI Support mean
          return content.replace(BADGE_REGEX, '![](https://img.shields.io/badge/$1%20Support-$2-$3.svg)');
        });
      }
    ].concat(window.$docsify.plugins || []);


    function collapseChildren(el) {
      el = getSidebarNode(el);
      var subNavEls = getChildren(el);
      for (var i = 0; i < subNavEls.length; i++) {
        collapseNavEl($(subNavEls[i]));
      }
    }

    /**
     * Collapses all sidebar elements that are cousins (1st, 2nd, whatever) of the element
     **/
    function collapseExtendedFamily(el) {
      el = getSidebarNode(el);
      collapseExtendedFamilyRecursion++;
      if (collapseExtendedFamilyRecursion > RECURSION_LIMIT) {
        console.error('collapseExtendedFamily recursion limit reached!');
        return;
      }
      var siblings = el.siblings();
      for (var i = 0; i < siblings.length; i++) {
        var sibling = $(siblings[i]);
        collapseNavElRecursion = 0;
        collapseNavEl(sibling);
      }
      var parentEl = el.parent().parent();  // li > ul > li
      if (!el.hasClass('sidebar-nav')) {
        collapseExtendedFamily(parentEl);
      }
      // TODO: It's currently recursing out of .sidebar-nav.  We should stop that once it gets to that point.
    }

    /**
     * Collapses the first level of the nav el that has links
     * Prevents us from collapsing a nav el that can't be expanded
     * @param el
     */
    function collapseNavEl(el) {
      collapseNavElRecursion++;
      if (collapseNavElRecursion > RECURSION_LIMIT) {
        console.error('collapseNavEl recursion limit reached!');
        return;
      }
      if (el.children()[0].tagName.toLowerCase() === 'a') {
        // Non-top-level link.  Collapse it.
        el.addClass('collapse');
      } else if (el.children()[0].tagName.toLowerCase() === 'p' &&
        $(el.children()[0]).children().length > 0 &&
        $(el.children()[0]).children()[0].tagName.toLowerCase() === 'a') {
        // Top-level link.  Collapse it.
        el.addClass('collapse');
      } else if (el.find('ul a').length) {
        // It's not a link but there's one in its children somewhere.  Go find it.
        collapseChildren(el);
      }
    }

    /**
     * @todo: Kinda poorly assumes el.children[1] is ul
     **/
    function getChildren(el) {
      return $(el.children()[1]).children();
    }

    /**
     * Returns the correct sidebar element to collapse based off of
     * The top level of the sidebar only sets .active on a child <p> so we need to go up to the
     * @param el
     */
    function getSidebarNode(el) {
      if (el[0].tagName.toLowerCase() === 'p' && el.hasClass('active')) {
        return el.parent();
      }
      return el;
    }
  </script>
</body>
</html>
