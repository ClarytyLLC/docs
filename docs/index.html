<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Veritone Docs</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="Veritone Docs">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <link rel="apple-touch-icon"
    sizes="180x180"
    href="https://static.veritone.com/assets/favicon/apple-touch-icon.png?v=lkgpRBRLYl"
  >
  <link rel="icon"
    type="image/png"
    href="https://static.veritone.com/assets/favicon/favicon-32x32.png?v=lkgpRBRLYl"
    sizes="32x32"
  >
  <link rel="icon"
    type="image/png"
    href="https://static.veritone.com/assets/favicon/favicon-16x16.png?v=lkgpRBRLYl"
    sizes="16x16"
  >
  <link rel="mask-icon"
    href="https://static.veritone.com/assets/favicon/safari-pinned-tab.svg?v=lkgpRBRLYl"
    color="#597cb1"
  >
  <link rel="shortcut icon"
    href="https://static.veritone.com/assets/favicon/favicon.ico"
    type="image/x-icon"
  >
  <link rel="stylesheet" href="//unpkg.com/docsify/lib/themes/vue.css">
  <link rel="stylesheet" href="//unpkg.com/docsify-copy-code/styles.css">

  <!--Custom CSS for collapsing all but current page-->
  <style>
    .sidebar-nav .collapse ul {
      display: none;
    }
  </style>
</head>
<body>
  <nav>
    <a href="https://chat.veritone.com/" target="_blank"><img src="/slack.svg" style="margin-right: 5px"/>Join us on Slack</a>
    <a id="new-issue-link" href="javascript:void(0)"><img src="/github.png" style="width:16px; margin-right: 5px"/>File an Issue</a>
  </nav>
  <div id="app"></div>
  <!-- <script src="//unpkg.com/docsify-copy-code/index.js"></script> -->
  <script>
    window.$docsify = {
      search: 'auto', // default
      maxLevel: 1,
      name: '<div><img src="https://static.veritone.com/assets/favicon/favicon.ico" height="18px" width="18px" style="margin-right: 5px" /> Veritone Docs</div>',
      repo: '',
      // routerMode: 'history',
      subMaxLevel: 2,
      loadSidebar: true,
      auto2top: true,
      // notFoundPage: {
      //   '\/(.*)(?<!\/)$': '1$/'
      // }
      alias: {
        '/.*/_sidebar.md': '/_sidebar.md',
        '^\/applications$': '/applications/',
        '^\/engines$': '/engines/',
        '^\/data$': '/data/',
        '^\/apis$': '/apis/',
        '^\/libraries$': '/libraries/',
        '^\/engines\/classes$': '/engines/classes/',
        '^\/engines\/guidelines$': '/engines/guidelines/',
        '^\/engines\/engine-input-output$': '/engines/engine-input-output/',
        '^\/engines\/tutorials$': '/engines/tutorials/',
        '^\/apis\/tutorials$': '/apis/tutorials/',
        '(.*)\/quick-start$': '$1/quick-start/'
      }
      // plugins: [
      //   window.DocsifyCopyCodePlugin.init()
      // ]
    }
    document.getElementById('new-issue-link').addEventListener('click', function() {
      window.open('https://github.com/veritone/docs/issues/new?title=' + encodeURIComponent('Issue on page: ' + (document.location.hash.slice(2) || 'Home')));
    });
  </script>
  <script src="//unpkg.com/docsify/lib/docsify.min.js"></script>
  <script src="//unpkg.com/docsify/lib/plugins/search.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-bash.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-graphql.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-python.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-json.min.js"></script>
  <script src="//unpkg.com/prismjs/components/prism-http.min.js"></script>

  <!--Custom script to collapse all other sidebar links besides active page-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>
    var RECURSION_LIMIT = 50;
    var collapseNavElRecursion = 0;
    var collapseExtendedFamilyRecursion = 0;

    // Custom docsify plugins
    window.$docsify.plugins = [

      /**
       * Sidebar Collapse
       * Collapses all sidebar elements that are cousins (1st, 2nd, whatever) of the current page
       **/
      function (hook, vm) {
        hook.doneEach(function onPageChanged() {
          collapseExtendedFamilyRecursion = 0;
          collapseExtendedFamily($('.sidebar-nav .active'));
        });
      },

      /**
       * "Support" Badges
       * Replaces instances of `![](badge/API/Yes/green)` with a badge from shields.io
       * with a label of "API Support", a value of "Yes", and a color of green.
       **/
      function (hook, vm) {
        hook.beforeEach(function onBeforePageParsed(content) {
          var BADGE_REGEX = /!\[]\(badge\/(\w+)\/(\w+)\/(\w+)\)/g;
          // TODO: Wrap with link to explanations of what API, Search, and UI Support mean
          return content.replace(BADGE_REGEX, '![](https://img.shields.io/badge/$1%20Support-$2-$3.svg)');
        });
      }
    ].concat(window.$docsify.plugins || []);


    function collapseExtendedFamily(el) {
      collapseExtendedFamilyRecursion++;
      if (collapseExtendedFamilyRecursion > RECURSION_LIMIT) {
        console.error('collapseExtendedFamily recursion limit reached!');
        return;
      }
      var siblings = el.siblings();
      for (var i = 0; i < siblings.length; i++) {
        var sibling = $(siblings[i]);
        collapseNavElRecursion = 0;
        collapseNavEl(sibling);
      }
      var parentEl = el.parent().parent();  // li > ul > li
      if (!el.hasClass('sidebar-nav')) {
        collapseExtendedFamily(parentEl);
      }
    }

    /**
     * Collapses the first level of the nav el that has links
     * Prevents us from collapsing a nav el that can't be expanded
     * @param el
     */
    function collapseNavEl(el) {
      collapseNavElRecursion++;
      if (collapseNavElRecursion > RECURSION_LIMIT) {
        console.error('collapseNavEl recursion limit reached!');
        return;
      }
      if (el.children()[0].tagName.toLowerCase() === 'a') {
        // Non-top-level link.  Collapse it.
        el.addClass('collapse');
      } else if (el.children()[0].tagName.toLowerCase() === 'p' &&
        $(el.children()[0]).children().length > 0 &&
        $(el.children()[0]).children()[0].tagName.toLowerCase() === 'a') {
        // Top-level link.  Collapse it.
        el.addClass('collapse');
      } else if (el.find('ul a').length) {
        // It's not a link but there's one in its children somewhere.  Go find it.
        var subNavEls = $(el.children()[1]).children();  // Kinda poorly assuming el.children[1] is ul
        for (var i = 0; i < subNavEls.length; i++) {
          collapseNavEl($(subNavEls[i]));
        }
      }
    }
  </script>
</body>
</html>
